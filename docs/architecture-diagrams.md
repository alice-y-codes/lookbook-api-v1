# Wardrobe Social API: Architecture Diagrams

## Hexagonal Architecture Overview

```
┌─────────────────────────────────────────────────────────────────────────┐
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                                                                 │   │
│  │  ┌─────────────────────────────────────────────────────────┐   │   │
│  │  │                                                         │   │   │
│  │  │                    Domain Layer                         │   │   │
│  │  │                                                         │   │   │
│  │  │   ┌───────────┐   ┌───────────┐   ┌───────────┐        │   │   │
│  │  │   │           │   │           │   │           │        │   │   │
│  │  │   │   User    │   │ Wardrobe  │   │  Outfit   │        │   │   │
│  │  │   │  Domain   │   │  Domain   │   │  Domain   │        │   │   │
│  │  │   │           │   │           │   │           │        │   │   │
│  │  │   └───────────┘   └───────────┘   └───────────┘        │   │   │
│  │  │                                                         │   │   │
│  │  │   ┌───────────┐   ┌───────────┐   ┌───────────┐        │   │   │
│  │  │   │           │   │           │   │           │        │   │   │
│  │  │   │   Item    │   │   Auth    │   │ Editorial │        │   │   │
│  │  │   │  Domain   │   │  Domain   │   │  Domain   │        │   │   │
│  │  │   │           │   │           │   │           │        │   │   │
│  │  │   └───────────┘   └───────────┘   └───────────┘        │   │   │
│  │  │                                                         │   │   │
│  │  │   ┌───────────┐   ┌───────────┐                        │   │   │
│  │  │   │           │   │           │                        │   │   │
│  │  │   │  Social   │   │   Comm    │                        │   │   │
│  │  │   │  Domain   │   │  Domain   │                        │   │   │
│  │  │   │           │   │           │                        │   │   │
│  │  │   └───────────┘   └───────────┘                        │   │   │
│  │  │                                                         │   │   │
│  │  └─────────────────────────────────────────────────────────┘   │   │
│  │                                                                 │   │
│  │                     Application Layer                           │   │
│  │                                                                 │   │
│  │  ┌─────────────────────────────┐  ┌─────────────────────────┐  │   │
│  │  │                             │  │                         │  │   │
│  │  │      Application Ports      │  │  Application Services   │  │   │
│  │  │      (Input/Output)         │  │                         │  │   │
│  │  │                             │  │                         │  │   │
│  │  └─────────────────────────────┘  └─────────────────────────┘  │   │
│  │                                                                 │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  ┌─────────────────────────────────┐  ┌─────────────────────────────┐  │
│  │                                 │  │                             │  │
│  │        API Adapters             │  │    Infrastructure Adapters  │  │
│  │  (Controllers, WebSockets)      │  │  (Repositories, Services)   │  │
│  │                                 │  │                             │  │
│  └─────────────────────────────────┘  └─────────────────────────────┘  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

## Test-Driven Development Flow

```
┌────────────────────────────────────────────────────────────────────────┐
│                                                                        │
│                   Test-Driven Development Cycle                        │
│                                                                        │
│  ┌─────────────┐        ┌─────────────┐        ┌─────────────┐        │
│  │             │        │             │        │             │        │
│  │  Write Test │───────►│  Implement  │───────►│  Refactor   │        │
│  │             │        │    Code     │        │             │        │
│  │             │        │             │        │             │        │
│  └─────────────┘        └─────────────┘        └─────────────┘        │
│        ▲                                              │               │
│        │                                              │               │
│        └──────────────────────────────────────────────┘               │
│                                                                        │
└────────────────────────────────────────────────────────────────────────┘
```

## Domain Model

```
┌───────────────────────────────────────────────────────────────────────────┐
│                                                                           │
│                              Domain Model                                 │
│                                                                           │
│  ┌─────────────┐     ┌─────────────┐      ┌─────────────┐                │
│  │    User     │     │   Wardrobe  │      │    Item     │                │
│  │             │     │             │      │             │                │
│  │ - id        │     │ - id        │      │ - id        │                │
│  │ - username  │     │ - name      │      │ - name      │                │
│  │ - email     │◄────┤ - userId    │◄─────┤ - wardrobeId│                │
│  │ - password  │     │ - createdAt │      │ - category  │                │
│  │ - profile   │     │ - updatedAt │      │ - brand     │                │
│  │ - privacy   │     │ - visibility│      │ - color     │                │
│  └─────────────┘     └─────────────┘      │ - size      │                │
│         ▲                   ▲              │ - imageUrl  │                │
│         │                   │              │ - createdAt │                │
│         │                   │              └─────────────┘                │
│         │                   │                     ▲                       │
│         │                   │                     │                       │
│  ┌─────────────┐     ┌─────────────┐      ┌─────────────┐                │
│  │  Friend     │     │ WardrobeAccess│     │   Outfit    │                │
│  │ Relationship│     │             │      │             │                │
│  │ - id        │     │ - id        │      │ - id        │                │
│  │ - userId    │     │ - wardrobeId│      │ - name      │                │
│  │ - friendId  │     │ - userId    │      │ - userId    │                │
│  │ - status    │     │ - accessType│      │ - createdAt │                │
│  │ - createdAt │     │ - createdAt │      │ - updatedAt │                │
│  │ - updatedAt │     │ - updatedAt │      │             │                │
│  └─────────────┘     └─────────────┘      └─────────────┘                │
│                                                  ▲                        │
│                                                  │                        │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐                │
│  │ Notification│     │  Message    │     │OutfitItem   │                │
│  │             │     │             │     │             │                │
│  │ - id        │     │ - id        │     │ - id        │                │
│  │ - userId    │     │ - senderId  │     │ - outfitId  │                │
│  │ - type      │     │ - receiverId│     │ - itemId    │                │
│  │ - content   │     │ - content   │     │ - wardrobeId│                │
│  │ - isRead    │     │ - createdAt │     │ - position  │                │
│  │ - createdAt │     │ - isRead    │     │ - createdAt │                │
│  └─────────────┘     └─────────────┘     └─────────────┘                │
│                                                                           │
└───────────────────────────────────────────────────────────────────────────┘
```

## MVP Progression Architecture

```
┌───────────────────────────────────────────────────────────────────────────┐
│                                                                           │
│                         MVP Progression Architecture                      │
│                                                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │                                                                     │  │
│  │                             MVP4 (Week 16)                          │  │
│  │                                                                     │  │
│  │   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐            │  │
│  │   │ Collaborative│   │ Direct      │    │ Enhanced    │            │  │
│  │   │ Outfits      │   │ Messaging   │    │ Notifications│           │  │
│  │   └─────────────┘    └─────────────┘    └─────────────┘            │  │
│  │                                                                     │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                  ▲                                         │
│                                  │                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │                                                                     │  │
│  │                             MVP3 (Week 12)                          │  │
│  │                                                                     │  │
│  │   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐            │  │
│  │   │ Magazine    │    │ Follow/     │    │ Activity    │            │  │
│  │   │ Layouts     │    │ Follower    │    │ Feed        │            │  │
│  │   └─────────────┘    └─────────────┘    └─────────────┘            │  │
│  │                                                                     │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                  ▲                                         │
│                                  │                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │                                                                     │  │
│  │                             MVP2 (Week 8)                           │  │
│  │                                                                     │  │
│  │   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐            │  │
│  │   │ Wardrobe    │    │ Item        │    │ Outfit      │            │  │
│  │   │ Management  │    │ Management  │    │ Creation    │            │  │
│  │   └─────────────┘    └─────────────┘    └─────────────┘            │  │
│  │                                                                     │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                  ▲                                         │
│                                  │                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │                                                                     │  │
│  │                             MVP1 (Week 4)                           │  │
│  │                                                                     │  │
│  │   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐            │  │
│  │   │ User        │    │ Profile     │    │ Authentication│          │  │
│  │   │ Registration│    │ Management  │    │ System       │           │  │
│  │   └─────────────┘    └─────────────┘    └─────────────┘            │  │
│  │                                                                     │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                                                           │
└───────────────────────────────────────────────────────────────────────────┘
```

## System Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│                           System Architecture                               │
│                                                                             │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐│
│  │             │     │             │     │             │     │             ││
│  │   Client    │     │   API       │     │ Application │     │  Domain     ││
│  │  (Browser/  │◄───►│  Gateway    │◄───►│  Services   │◄───►│  Services   ││
│  │   Mobile)   │     │             │     │             │     │             ││
│  │             │     │             │     │             │     │             ││
│  └─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘│
│                                                                    │        │
│                                                                    ▼        │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐│
│  │             │     │             │     │             │     │             ││
│  │    Redis    │     │  PostgreSQL │     │    S3       │     │ Repositories││
│  │  (Cache &   │◄───►│  Database   │◄───►│  Storage    │◄───►│             ││
│  │   Pub/Sub)  │     │             │     │             │     │             ││
│  │             │     │             │     │             │     │             ││
│  └─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘│
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## Test Coverage Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│                        Test Coverage Architecture                           │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                                                                     │   │
│  │                       End-to-End Tests                              │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  ┌─────────────────────────────┐       ┌─────────────────────────────┐     │
│  │                             │       │                             │     │
│  │        API Tests            │       │     Integration Tests       │     │
│  │                             │       │                             │     │
│  └─────────────────────────────┘       └─────────────────────────────┘     │
│                                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │             │  │             │  │             │  │             │        │
│  │  Domain     │  │ Application │  │ Repository  │  │ Infrastructure│      │
│  │  Tests      │  │ Tests       │  │ Tests       │  │ Tests        │       │
│  │             │  │             │  │             │  │             │        │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## Authentication Flow

```
┌─────────┐                  ┌─────────┐                  ┌─────────┐
│         │                  │         │                  │         │
│ Client  │                  │  API    │                  │ Auth    │
│         │                  │ Gateway │                  │ Service │
│         │                  │         │                  │         │
└────┬────┘                  └────┬────┘                  └────┬────┘
     │                            │                            │
     │ 1. Login Request           │                            │
     │ (username/password)        │                            │
     │ -------------------------► │                            │
     │                            │ 2. Authenticate User       │
     │                            │ -------------------------► │
     │                            │                            │
     │                            │                            │ 3. Validate
     │                            │                            │    Credentials
     │                            │                            │
     │                            │ 4. Generate JWT +          │
     │                            │    Refresh Token           │
     │                            │ ◄------------------------- │
     │ 5. Return Tokens           │                            │
     │ ◄------------------------- │                            │
     │                            │                            │
     │ 6. API Request with JWT    │                            │
     │ -------------------------► │                            │
     │                            │ 7. Validate JWT            │
     │                            │ -------------------------► │
     │                            │                            │
     │                            │ 8. JWT Valid/Invalid       │
     │                            │ ◄------------------------- │
     │                            │                            │
     │ 9. API Response            │                            │
     │ ◄------------------------- │                            │
     │                            │                            │
     │ 10. Refresh Token Request  │                            │
     │ -------------------------► │                            │
     │                            │ 11. Validate Refresh Token │
     │                            │ -------------------------► │
     │                            │                            │
     │                            │ 12. Generate New JWT +     │
     │                            │     Refresh Token          │
     │                            │ ◄------------------------- │
     │ 13. Return New Tokens      │                            │
     │ ◄------------------------- │                            │
     │                            │                            │
```

## Magazine-Style Layout Flow

```
┌─────────┐                  ┌─────────┐                  ┌─────────┐
│         │                  │         │                  │         │
│ Client  │                  │ Editorial│                 │ Item    │
│         │                  │ Service  │                 │ Service │
│         │                  │         │                  │         │
└────┬────┘                  └────┬────┘                  └────┬────┘
     │                            │                            │
     │ 1. Request Editorial       │                            │
     │ -------------------------► │                            │
     │                            │                            │
     │                            │ 2. Get Editorial Layout    │
     │                            │ -------------------------► │
     │                            │                            │
     │                            │ 3. Return Items            │
     │                            │ ◄------------------------- │
     │                            │                            │
     │                            │ 4. Compose Magazine Layout │
     │                            │                            │
     │ 5. Return Editorial        │                            │
     │ ◄------------------------- │                            │
     │                            │                            │
     │ 6. Render Magazine View    │                            │
     │                            │                            │
     │ 7. User Flips Page         │                            │
     │                            │                            │
     │ 8. Request Next Page       │                            │
     │ -------------------------► │                            │
     │                            │                            │
     │ 9. Return Next Page        │                            │
     │ ◄------------------------- │                            │
     │                            │                            │
```

## Collaborative Features Flow

```
┌─────────┐                  ┌─────────┐                  ┌─────────┐
│         │                  │         │                  │         │
│ User A  │                  │ Collab  │                  │ User B  │
│ Client  │                  │ Service │                  │ Client  │
│         │                  │         │                  │         │
└────┬────┘                  └────┬────┘                  └────┬────┘
     │                            │                            │
     │ 1. Share Wardrobe Item     │                            │
     │ -------------------------► │                            │
     │                            │                            │
     │                            │ 2. Notify User B           │
     │                            │ -------------------------► │
     │                            │                            │
     │                            │                            │
     │                            │ 3. Accept Shared Item      │
     │                            │ ◄------------------------- │
     │                            │                            │
     │                            │ 4. Create Remix Permission │
     │                            │                            │
     │                            │ 5. Notify User A           │
     │                            │ -------------------------► │
     │ 6. Acknowledge             │                            │
     │ ◄------------------------- │                            │
     │                            │                            │
     │                            │ 7. Create New Outfit       │
     │                            │ ◄------------------------- │
     │                            │                            │
     │                            │ 8. Mix Items from Both     │
     │                            │    Wardrobes               │
     │                            │                            │
     │                            │ 9. Save Collaborative      │
     │                            │    Outfit                  │
     │                            │                            │
     │                            │ 10. Notify User A          │
     │ 11. View Collaborative     │ ◄------------------------- │
     │     Outfit                 │                            │
     │ ◄------------------------- │                            │
     │                            │                            │
```

## Friend Relationship Flow

```
┌─────────┐                  ┌─────────┐                  ┌─────────┐
│         │                  │         │                  │         │
│ User A  │                  │ Friend  │                  │ User B  │
│ Client  │                  │ Service │                  │ Client  │
│         │                  │         │                  │         │
└────┬────┘                  └────┬────┘                  └────┬────┘
     │                            │                            │
     │ 1. Send Friend Request     │                            │
     │ -------------------------► │                            │
     │                            │                            │
     │                            │ 2. Create Friend Request   │
     │                            │    (PENDING status)        │
     │                            │                            │
     │                            │ 3. Notify User B           │
     │                            │ -------------------------► │
     │                            │                            │
     │                            │                            │
     │                            │ 4. Accept Friend Request   │
     │                            │ ◄------------------------- │
     │                            │                            │
     │                            │ 5. Update Relationship     │
     │                            │    (ACCEPTED status)       │
     │                            │                            │
     │                            │ 6. Grant Wardrobe Access   │
     │                            │    (based on settings)     │
     │                            │                            │
     │                            │ 7. Notify User A           │
     │ 8. Friendship Confirmed    │ ◄------------------------- │
     │ ◄------------------------- │                            │
     │                            │                            │
```

## Wardrobe Access Control Flow

```
┌─────────┐                  ┌─────────┐                  ┌─────────┐
│         │                  │         │                  │         │
│ User    │                  │ Wardrobe│                  │ Access  │
│ Client  │                  │ Service │                  │ Control │
│         │                  │         │                  │ Service │
└────┬────┘                  └────┬────┘                  └────┬────┘
     │                            │                            │
     │ 1. Request Wardrobe Access │                            │
     │ -------------------------► │                            │
     │                            │                            │
     │                            │ 2. Check Access Permission │
     │                            │ -------------------------► │
     │                            │                            │
     │                            │                            │ 3. Verify User
     │                            │                            │    Relationship
     │                            │                            │
     │                            │                            │ 4. Check Wardrobe
     │                            │                            │    Visibility
     │                            │                            │
     │                            │ 5. Access Decision         │
     │                            │ ◄------------------------- │
     │                            │                            │
     │ 6. Wardrobe Data or        │                            │
     │    Access Denied           │                            │
     │ ◄------------------------- │                            │
     │                            │                            │
```

## Cross-Wardrobe Outfit Creation Flow

```
┌─────────┐                  ┌─────────┐                  ┌─────────┐
│         │                  │         │                  │         │
│ User A  │                  │ Outfit  │                  │ Access  │
│ Client  │                  │ Service │                  │ Control │
│         │                  │         │                  │ Service │
└────┬────┘                  └────┬────┘                  └────┬────┘
     │                            │                            │
     │ 1. Create Outfit with      │                            │
     │    Items from Friend's     │                            │
     │    Wardrobe                │                            │
     │ -------------------------► │                            │
     │                            │                            │
     │                            │ 2. Verify Access to Items  │
     │                            │ -------------------------► │
     │                            │                            │
     │                            │                            │ 3. Check Access
     │                            │                            │    for Each Item
     │                            │                            │
     │                            │ 4. Access Verification     │
     │                            │ ◄------------------------- │
     │                            │                            │
     │                            │ 5. Create Cross-Wardrobe   │
     │                            │    Outfit                  │
     │                            │                            │
     │ 6. Outfit Created or       │                            │
     │    Access Denied           │                            │
     │ ◄------------------------- │                            │
     │                            │                            │
     │                            │ 7. Notify Friend (User B)  │
     │                            │ -------------------------► │
     │                            │                            │
```

## Deployment Architecture

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│                           Kubernetes Cluster                                │
│                                                                             │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐│
│  │             │     │             │     │             │     │             ││
│  │  Ingress    │     │   API       │     │ Application │     │  Domain     ││
│  │  Controller │◄───►│  Gateway    │◄───►│  Services   │◄───►│  Services   ││
│  │             │     │  (3 pods)   │     │  (3 pods)   │     │  (3 pods)   ││
│  │             │     │             │     │             │     │             ││
│  └─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘│
│         ▲                                                                   │
│         │                                                                   │
│         │            ┌─────────────┐     ┌─────────────┐     ┌─────────────┐│
│         │            │             │     │             │     │             ││
│  ┌─────────────┐     │  Redis      │     │ PostgreSQL  │     │ Monitoring  ││
│  │             │     │  Cluster    │     │  Cluster    │     │ (Prometheus/││
│  │    CDN      │     │  (3 pods)   │     │  (3 pods)   │     │  Grafana)   ││
│  │             │     │             │     │             │     │             ││
│  └─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘│
│         ▲                                                                   │
│         │                                                                   │
└─────────┼───────────────────────────────────────────────────────────────────┘
          │
┌─────────┼───────────────────────────────────────────────────────────────────┐
│         │                                                                   │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐                    │
│  │             │     │             │     │             │                    │
│  │    S3       │     │  CloudFront │     │   Route53   │                    │
│  │  Storage    │◄───►│    CDN      │◄───►│    DNS      │                    │
│  │             │     │             │     │             │                    │
│  └─────────────┘     └─────────────┘     └─────────────┘                    │
│                                                                             │
│                           AWS Cloud Services                                │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
``` 